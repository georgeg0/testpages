
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Lecture 2: SQL - Class 2 &#8212; CPSC 304 Introduction to Relational Databases</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="CPSC 304 Introduction to Relational Databases" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/demo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CPSC 304 Introduction to Relational Databases</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Lecture 2: SQL - Class 2
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/lecture2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/ggeorg02/BAIT580/issues/new?title=Issue%20on%20page%20%2Flectures/lecture2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/ggeorg02/BAIT580/edit/master/lectures/lecture2.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ggeorg02/BAIT580/master?urlpath=tree/lectures/lecture2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#today-s-agenda">
   1.1. Today‚Äôs Agenda
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warm-up">
   1.2. Warm-up ‚òïÔ∏è
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#refresher-take-some-time-and-think-if-you-know">
     1.2.1. Refresher!! Take some time and think if you know‚Ä¶
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#refresher-exercise">
     1.2.2. Refresher exercise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-objectives">
   1.3. Learning objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lap-1">
   1.4. Lap 1 ü•õ
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distinct">
     1.4.1. DISTINCT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#order-by">
     1.4.2. ORDER BY
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#limit">
     1.4.3. LIMIT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checkpoint-1-take-some-time-and-think-if-you-can">
     1.4.4. Checkpoint 1 !! Take some time and think if you can‚Ä¶
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-point-1-exercise">
     1.4.5. Check point 1 exercise.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iclicker-questions">
       1.4.5.1. iclicker questions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reasoning-question">
       1.4.5.2. Reasoning Question
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lap-2">
   1.5. Lap 2 üßã
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregations">
     1.5.1. Aggregations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping">
     1.5.2. Grouping
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#having">
     1.5.3. HAVING
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-alias-as">
     1.5.4. Using alias (AS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checkpoint-2-take-some-time-and-think-if-you-can">
     1.5.5. Checkpoint 2 !! Take some time and think if you can‚Ä¶
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-point-2-exercise">
     1.5.6. Check point 2 exercise.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       1.5.6.1. iclicker questions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       1.5.6.2. Reasoning Question
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lap-3">
   1.6. Lap 3 üßÉ
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#join">
     1.6.1. Join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cross-join">
     1.6.2. Cross join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inner-join">
     1.6.3. Inner join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outer-join">
     1.6.4. Outer join
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#left-outer">
       1.6.4.1. Left outer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#right-outer">
       1.6.4.2. Right outer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#full-outer">
       1.6.4.3. Full outer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summarize">
     1.6.5. Summarize:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checkpoint-3-take-some-time-and-think-if-you-can">
     1.6.6. Checkpoint 3 !! Take some time and think if you can‚Ä¶
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-point-3-exercise">
     1.6.7. Check point 3 exercise.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       1.6.7.1. iclicker questions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finish-line">
   1.7. üèÅ Finish line üèÅ üç∫
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="lecture-2-sql-class-2">
<h1><span class="section-number">1. </span>Lecture 2: SQL - Class 2<a class="headerlink" href="#lecture-2-sql-class-2" title="Permalink to this headline">¬∂</a></h1>
<p>Gittu George, February 24 2022</p>
<div class="section" id="today-s-agenda">
<h2><span class="section-number">1.1. </span>Today‚Äôs Agenda<a class="headerlink" href="#today-s-agenda" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p>Refresher (Warm-up)</p></li>
<li><p>Refresher exercise</p></li>
<li><p>Learning objectives</p></li>
<li><p>More SQL commands (lap 1)</p></li>
<li><p>Aggregations (lap 2)</p></li>
<li><p>Grouping (lap 2)</p></li>
<li><p>Joins (lap 3)</p></li>
<li><p>Summary (finish line)</p></li>
</ul>
</div>
<div class="section" id="warm-up">
<h2><span class="section-number">1.2. </span>Warm-up ‚òïÔ∏è<a class="headerlink" href="#warm-up" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="refresher-take-some-time-and-think-if-you-know">
<h3><span class="section-number">1.2.1. </span>Refresher!! Take some time and think if you know‚Ä¶<a class="headerlink" href="#refresher-take-some-time-and-think-if-you-know" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>What are databases?</p></li>
<li><p>Where is it commonly used?</p></li>
<li><p>How to set up a database?</p></li>
<li><p>General structure of a database</p></li>
<li><p>Various ways of interacting with the database, using</p>
<ul>
<li><p>command-line interface</p></li>
<li><p>ODBC drivers via developer interfaces like pgadmin and toad.</p></li>
<li><p>jupyter notebook ( which we will be using throughout the course)</p></li>
</ul>
</li>
<li><p>To create a table and various data types</p></li>
<li><p>Integrity constraints such as primary key and foreign key</p></li>
<li><p>Basic SQL commands like SELECT, FROM, and WHERE</p></li>
</ul>
<p>In this class, we will be using the tables that we created in lecture 1. Here are the scripts if you want to recreate the classroom exercise table.</p>
<div class="toggle docutils container">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="n">students</span><span class="p">,</span><span class="n">courses</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">students</span><span class="p">(</span>
<span class="n">student_no</span> <span class="nb">integer</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> 
<span class="n">stud_name</span> <span class="nb">text</span><span class="p">,</span>
<span class="n">age</span> <span class="nb">integer</span><span class="p">,</span>
<span class="n">major</span> <span class="nb">text</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">courses</span><span class="p">(</span>
<span class="n">id</span> <span class="nb">SERIAL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
<span class="n">student_no</span> <span class="nb">integer</span><span class="p">,</span> 
<span class="n">course_name</span> <span class="nb">text</span><span class="p">,</span>
<span class="n">course_year</span> <span class="nb">integer</span><span class="p">,</span>
<span class="n">course_percentage</span> <span class="nb">float</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">students</span><span class="p">(</span><span class="n">student_no</span><span class="p">,</span><span class="n">stud_name</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">major</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="s1">&#39;Catherine&#39;</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">222</span><span class="p">,</span><span class="s1">&#39;Tiff&#39;</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="s1">&#39;MDS&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">333</span><span class="p">,</span><span class="s1">&#39;John&#39;</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">444</span><span class="p">,</span><span class="s1">&#39;Amir&#39;</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">555</span><span class="p">,</span><span class="s1">&#39;Gittu&#39;</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;MDS&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">666</span><span class="p">,</span><span class="s1">&#39;Isha&#39;</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">777</span><span class="p">,</span><span class="s1">&#39;Heidy&#39;</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">888</span><span class="p">,</span><span class="s1">&#39;Angela&#39;</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">999</span><span class="p">,</span><span class="s1">&#39;Jason&#39;</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="s1">&#39;MBAN&#39;</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">courses</span><span class="p">(</span><span class="n">student_no</span><span class="p">,</span><span class="n">course_name</span><span class="p">,</span><span class="n">course_year</span><span class="p">,</span><span class="n">course_percentage</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="s1">&#39;TPCS INFO TECH&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">88</span><span class="p">),</span>
<span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="s1">&#39;Data Visualization&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">88</span><span class="p">),</span>
<span class="p">(</span><span class="mi">222</span><span class="p">,</span><span class="s1">&#39;Health and Technology&#39;</span><span class="p">,</span><span class="mi">2020</span><span class="p">,</span><span class="mi">80</span><span class="p">),</span>
<span class="p">(</span><span class="mi">222</span><span class="p">,</span><span class="s1">&#39;Web and Cloud Computing&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">91</span><span class="p">),</span>
<span class="p">(</span><span class="mi">222</span><span class="p">,</span><span class="s1">&#39;Spark Programming&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span>
<span class="p">(</span><span class="mi">333</span><span class="p">,</span><span class="s1">&#39;Parallel Computing&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span>
<span class="p">(</span><span class="mi">444</span><span class="p">,</span><span class="s1">&#39;Large Scale Infrastructures&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">83</span><span class="p">),</span>
<span class="p">(</span><span class="mi">444</span><span class="p">,</span><span class="s1">&#39;TPCS INFO TECH&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">98</span><span class="p">),</span>
<span class="p">(</span><span class="mi">555</span><span class="p">,</span><span class="s1">&#39;TPCS INFO TECH&#39;</span><span class="p">,</span><span class="mi">2020</span><span class="p">,</span><span class="mi">78</span><span class="p">),</span>
<span class="p">(</span><span class="mi">555</span><span class="p">,</span><span class="s1">&#39;Health and Technology&#39;</span><span class="p">,</span><span class="mi">2020</span><span class="p">,</span><span class="mi">81</span><span class="p">),</span>
<span class="p">(</span><span class="mi">666</span><span class="p">,</span><span class="s1">&#39;Data Visualization&#39;</span><span class="p">,</span><span class="mi">2021</span><span class="p">,</span><span class="mi">85</span><span class="p">),</span>
<span class="p">(</span><span class="mi">666</span><span class="p">,</span><span class="s1">&#39;Parallel Computing&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">87</span><span class="p">),</span>
<span class="p">(</span><span class="mi">888</span><span class="p">,</span><span class="s1">&#39;Spark Programming&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">93</span><span class="p">),</span>
<span class="p">(</span><span class="mi">999</span><span class="p">,</span><span class="s1">&#39;TPCS INFO TECH&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">98</span><span class="p">),</span>
<span class="p">(</span><span class="mi">999</span><span class="p">,</span><span class="s1">&#39;Data Visualization&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">87</span><span class="p">),</span>
<span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="s1">&#39;C programming&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">87</span><span class="p">),</span>
<span class="p">(</span><span class="mi">1111</span><span class="p">,</span><span class="s1">&#39;Introduction to Genomics&#39;</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">87</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>First of all let‚Äôs load SQL to work on this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_HOST&#39;</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_USER&#39;</span><span class="p">)</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_PASS&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> sql
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> postgresql://{user}:{password}@{host}:5432/postgres
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Connected: postgres@postgres&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="refresher-exercise">
<h3><span class="section-number">1.2.2. </span>Refresher exercise<a class="headerlink" href="#refresher-exercise" title="Permalink to this headline">¬∂</a></h3>
<p><em><strong>Question 1:</strong></em> In this table <code class="docutils literal notranslate"><span class="pre">eg</span></code></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>firstname</p></th>
<th class="head"><p>countryfrom</p></th>
<th class="head"><p>continent</p></th>
<th class="head"><p>gender</p></th>
<th class="head"><p>age</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>matt</p></td>
<td><p>usa</p></td>
<td><p>north america</p></td>
<td><p>M</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-odd"><td><p>jenn</p></td>
<td><p>uk</p></td>
<td><p>europe</p></td>
<td><p>F</p></td>
<td><p>35</p></td>
</tr>
<tr class="row-even"><td><p>guy</p></td>
<td><p>france</p></td>
<td><p>europe</p></td>
<td><p>M</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-odd"><td><p>james</p></td>
<td><p>china</p></td>
<td><p>asia</p></td>
<td><p>M</p></td>
<td><p>29</p></td>
</tr>
<tr class="row-even"><td><p>lida</p></td>
<td><p>india</p></td>
<td><p>asia</p></td>
<td><p>F</p></td>
<td><p>56</p></td>
</tr>
<tr class="row-odd"><td><p>linda</p></td>
<td><p>canada</p></td>
<td><p>north america</p></td>
<td><p>F</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-even"><td><p>sofia</p></td>
<td><p>germany</p></td>
<td><p>europe</p></td>
<td><p>F</p></td>
<td><p>22</p></td>
</tr>
<tr class="row-odd"><td><p>george</p></td>
<td><p>india</p></td>
<td><p>asia</p></td>
<td><p>M</p></td>
<td><p>29</p></td>
</tr>
</tbody>
</table>
<p>What will be returned from following SQL</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">firstname</span><span class="p">,</span><span class="n">gender</span> <span class="k">from</span> <span class="n">eg</span> <span class="k">where</span> <span class="n">continent</span> <span class="o">=</span><span class="s1">&#39;asia&#39;</span> <span class="k">AND</span> <span class="n">age</span> <span class="o">=</span><span class="mi">29</span>
</pre></div>
</div>
<p>A) george,M</p>
<p>B) george,M,asia,29</p>
<p>C) george,india,asia, M,29</p>
<p>D) M,george</p>
<p>E) M,james</p>
<div class="toggle docutils container">
<p><em><strong>Answer: D</strong></em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Remember the order of the columns returned will be based on the order of columns that we specify within the select statement.</p>
</div>
</div>
<p><em><strong>Question 2:</strong></em> Consider a scenario where you want to perform analysis on a table (peopletable) with 100 columns (including personname,age,gender,origin‚Ä¶etc.) that define a person. You are interested in seeing the name of individuals older than 90. Which SQL query is more appropriate in this situation?</p>
<p>A) <em><strong>select * from peopletable where age &gt; 90;</strong></em></p>
<p>B) <em><strong>select personname,age from peopletable where age &gt; 90;</strong></em></p>
<p>B) <em><strong>select personname,age,gender,origin from peopletable where age &lt; 90;</strong></em></p>
<p>D) <em><strong>select personname from peopletable where age &gt; 90;</strong></em></p>
<div class="toggle docutils container">
<p><em><strong>Answer:  D</strong></em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Just bring the columns and rows that are needed. Even though <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> and <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> are very basic SQL commands, it‚Äôs crucial when you are dealing with a large table</p>
</div>
</div>
</div>
</div>
<div class="section" id="learning-objectives">
<h2><span class="section-number">1.3. </span>Learning objectives<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p>You will be able to create SQL queries using (Lap 1 &amp; Lap 2)</p>
<ul>
<li><p>Distinct,</p></li>
<li><p>ORDER BY,</p></li>
<li><p>LIMIT,</p></li>
<li><p>GROUP BY,</p></li>
<li><p>alias AS</p></li>
</ul>
</li>
<li><p>You will learn about different kinds of joins and be able to create SQL queries that perform <code class="docutils literal notranslate"><span class="pre">JOINS</span></code>. (Lap 3)</p></li>
</ul>
</div>
<div class="section" id="lap-1">
<h2><span class="section-number">1.4. </span>Lap 1 ü•õ<a class="headerlink" href="#lap-1" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="distinct">
<h3><span class="section-number">1.4.1. </span>DISTINCT<a class="headerlink" href="#distinct" title="Permalink to this headline">¬∂</a></h3>
<p>The DISTINCT statement is used only to return distinct elements from a table.</p>
<p><em><strong>Syntax:</strong></em></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">column1</span><span class="p">,</span> <span class="n">column2</span><span class="p">,</span> <span class="p">...</span><span class="n">columnN</span>
<span class="k">FROM</span> <span class="n">tablename</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> is applied to all columns that follows the <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> keyword. Say for eg if we give <code class="docutils literal notranslate"><span class="pre">DISTINCT</span> <span class="pre">column1,</span> <span class="pre">column2</span></code> then the combination of values in both <code class="docutils literal notranslate"><span class="pre">column1</span></code> and <code class="docutils literal notranslate"><span class="pre">column2</span></code> columns will be used for returning the unique combination (or removing the duplicate elements).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT DISTINCT course_name FROM courses;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
9 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>course_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>Introduction to Genomics</td>
        </tr>
        <tr>
            <td>Large Scale Infrastructures</td>
        </tr>
        <tr>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>Web and Cloud Computing</td>
        </tr>
        <tr>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>C programming</td>
        </tr>
        <tr>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>Parallel Computing</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT DISTINCT course_name, course_year FROM courses;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
11 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>course_name</th>
            <th>course_year</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Parallel Computing</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>C programming</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>Spark Programming</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>Health and Technology</td>
            <td>2020</td>
        </tr>
        <tr>
            <td>Introduction to Genomics</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
        </tr>
        <tr>
            <td>Data Visualization</td>
            <td>2021</td>
        </tr>
        <tr>
            <td>Data Visualization</td>
            <td>2019</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="order-by">
<h3><span class="section-number">1.4.2. </span>ORDER BY<a class="headerlink" href="#order-by" title="Permalink to this headline">¬∂</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> statement sorts the results returned by <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> based on a sort expression.</p>
<p>Syntax</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">column1</span><span class="p">,</span> <span class="n">column2</span> <span class="p">...</span><span class="n">columnN</span>
<span class="k">FROM</span> <span class="k">table_name</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">column1</span> <span class="p">[</span><span class="k">ASC</span> <span class="o">|</span> <span class="k">DESC</span><span class="p">],</span> <span class="n">column2</span> <span class="p">[</span><span class="k">ASC</span> <span class="o">|</span> <span class="k">DESC</span><span class="p">]</span> <span class="p">....</span><span class="n">columnN</span> <span class="p">[</span><span class="k">ASC</span><span class="o">|</span><span class="k">DESC</span><span class="p">];</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, it will sort in ASC. So you can choose not to give ASC.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT * 
FROM courses
ORDER BY course_year;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>id</th>
            <th>student_no</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT * 
FROM courses
ORDER BY course_year DESC;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>id</th>
            <th>student_no</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="limit">
<h3><span class="section-number">1.4.3. </span>LIMIT<a class="headerlink" href="#limit" title="Permalink to this headline">¬∂</a></h3>
<p>Until now, we were returning everything that our SQL query returns. <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> statement is used to limit the number of rows that are returned.</p>
<p>syntax:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">column1</span><span class="p">,</span> <span class="n">column2</span><span class="p">,</span> <span class="p">...</span><span class="n">columnN</span>
<span class="k">FROM</span> <span class="n">tablename</span>
<span class="k">LIMIT</span> <span class="n">numberofrows</span><span class="p">;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT * 
FROM courses
LIMIT 2;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
2 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>id</th>
            <th>student_no</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> keyword is used in a variety of situations. Here are a few cases</p>
<ul class="simple">
<li><p><em><strong>Memory Management:</strong></em> Say you just want to look at the output your query returns. If you are dealing with lots and lots of rows, returning the entire rows can slow down the query, cause memory issues, and finally crash your jupyter. In these cases, you can use <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code>.</p></li>
<li><p><em><strong>Interest in the first few rows:</strong></em> If we are interested in just the first N rows, we can achieve that using <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code>. People tend to use <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> a lot when they want to return the top 10 rows after performing an <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code></p></li>
</ul>
<p>Let‚Äôs apply all the statements that we learned in one statement.</p>
<p><em><strong>Question:</strong></em> List out the row that got the highest <code class="docutils literal notranslate"><span class="pre">course_percentage</span></code> for the <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Visualization</span></code> course.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT * 
FROM courses
WHERE  course_name = &#39;Data Visualization&#39;
ORDER BY course_percentage DESC
LIMIT 1;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
1 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>id</th>
            <th>student_no</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> select age from eg order by age
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>age</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>18</td>
        </tr>
        <tr>
            <td>22</td>
        </tr>
        <tr>
            <td>23</td>
        </tr>
        <tr>
            <td>25</td>
        </tr>
        <tr>
            <td>29</td>
        </tr>
        <tr>
            <td>29</td>
        </tr>
        <tr>
            <td>35</td>
        </tr>
        <tr>
            <td>56</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="checkpoint-1-take-some-time-and-think-if-you-can">
<h3><span class="section-number">1.4.4. </span>Checkpoint 1 !! Take some time and think if you can‚Ä¶<a class="headerlink" href="#checkpoint-1-take-some-time-and-think-if-you-can" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>Select columns and bring in rows just what we need (using <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">WHERE</span></code>)</p></li>
<li><p>Return <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> rows returned based on column(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> the number of rows returned</p></li>
</ul>
<p>Now we will learn some more advanced SQL operations to gain more insight into the data. But, before that, let‚Äôs do some exercise.</p>
</div>
<div class="section" id="check-point-1-exercise">
<h3><span class="section-number">1.4.5. </span>Check point 1 exercise.<a class="headerlink" href="#check-point-1-exercise" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="iclicker-questions">
<h4><span class="section-number">1.4.5.1. </span>iclicker questions<a class="headerlink" href="#iclicker-questions" title="Permalink to this headline">¬∂</a></h4>
<p>Answer the following questions using the table <code class="docutils literal notranslate"><span class="pre">eg</span></code></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>firstname</p></th>
<th class="head"><p>countryfrom</p></th>
<th class="head"><p>continent</p></th>
<th class="head"><p>gender</p></th>
<th class="head"><p>age</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>matt</p></td>
<td><p>usa</p></td>
<td><p>north america</p></td>
<td><p>M</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-odd"><td><p>jenn</p></td>
<td><p>uk</p></td>
<td><p>europe</p></td>
<td><p>F</p></td>
<td><p>35</p></td>
</tr>
<tr class="row-even"><td><p>guy</p></td>
<td><p>france</p></td>
<td><p>europe</p></td>
<td><p>M</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-odd"><td><p>james</p></td>
<td><p>china</p></td>
<td><p>asia</p></td>
<td><p>M</p></td>
<td><p>29</p></td>
</tr>
<tr class="row-even"><td><p>lida</p></td>
<td><p>india</p></td>
<td><p>asia</p></td>
<td><p>F</p></td>
<td><p>56</p></td>
</tr>
<tr class="row-odd"><td><p>linda</p></td>
<td><p>canada</p></td>
<td><p>north america</p></td>
<td><p>F</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-even"><td><p>sofia</p></td>
<td><p>germany</p></td>
<td><p>europe</p></td>
<td><p>F</p></td>
<td><p>22</p></td>
</tr>
<tr class="row-odd"><td><p>george</p></td>
<td><p>india</p></td>
<td><p>asia</p></td>
<td><p>M</p></td>
<td><p>29</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Question 1:</strong></em> How many elements will be returned from this SQL</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="k">DISTINCT</span> <span class="n">gender</span><span class="p">,</span><span class="n">firstname</span> <span class="k">from</span> <span class="n">eg</span>
</pre></div>
</div>
<p>A) 2</p>
<p>B) 8</p>
<p>C) 4</p>
<div class="toggle docutils container">
<p><em><strong>Answer: B</strong></em></p>
</div>
<p><em><strong>Question 2:</strong></em> What will be the first value returned from this SQL</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">eg</span> <span class="k">order</span> <span class="k">by</span> <span class="n">age</span>
</pre></div>
</div>
<p>A) 23</p>
<p>B) 18</p>
<p>C) 56</p>
<p>D) 35</p>
<div class="toggle docutils container">
<p><em><strong>Answer: B</strong></em></p>
</div>
</div>
<div class="section" id="reasoning-question">
<h4><span class="section-number">1.4.5.2. </span>Reasoning Question<a class="headerlink" href="#reasoning-question" title="Permalink to this headline">¬∂</a></h4>
<p><em><strong>Question 1:</strong></em> Write a SQL query to list the row that got the highest <code class="docutils literal notranslate"><span class="pre">course_percentage</span></code> for the <code class="docutils literal notranslate"><span class="pre">TPCS</span> <span class="pre">INFO</span> <span class="pre">TECH'</span></code> course. Can you spot any issues by examining the original table?</p>
<div class="toggle docutils container">
<p>You probably might have got this SQL query by changing the SQL query that we discussed for the ‚ÄúData Visualization‚Äù course.</p>
<p><em><strong>SELECT * FROM courses
WHERE  course_name = ‚ÄòTPCS INFO TECH‚Äô
ORDER BY course_percentage DESC
LIMIT 1;</strong></em></p>
<p>This gives you</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>id</p></th>
<th class="text-align:right head"><p>student_no</p></th>
<th class="text-align:right head"><p>course_name</p></th>
<th class="text-align:right head"><p>course_year</p></th>
<th class="text-align:right head"><p>course_percentage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>8</p></td>
<td class="text-align:right"><p>444</p></td>
<td class="text-align:right"><p>TPCS INFO TECH</p></td>
<td class="text-align:right"><p>2019</p></td>
<td class="text-align:right"><p>98.0</p></td>
</tr>
</tbody>
</table>
<p>What are possible issues? Take out the <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code>, and you might notice there is a tie, and 2 students, 444 and 999 scored the highest.</p>
<p><em><strong>SELECT * FROM courses
WHERE  course_name = ‚ÄòTPCS INFO TECH‚Äô
ORDER BY course_percentage DESC</strong></em></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>id</p></th>
<th class="text-align:right head"><p>student_no</p></th>
<th class="text-align:right head"><p>course_name</p></th>
<th class="text-align:right head"><p>course_year</p></th>
<th class="text-align:right head"><p>course_percentage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>8</p></td>
<td class="text-align:right"><p>444</p></td>
<td class="text-align:right"><p>TPCS INFO TECH</p></td>
<td class="text-align:right"><p>2019</p></td>
<td class="text-align:right"><p>98.0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>14</p></td>
<td class="text-align:right"><p>999</p></td>
<td class="text-align:right"><p>TPCS INFO TECH</p></td>
<td class="text-align:right"><p>2019</p></td>
<td class="text-align:right"><p>98.0</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>1</p></td>
<td class="text-align:right"><p>111</p></td>
<td class="text-align:right"><p>TPCS INFO TECH</p></td>
<td class="text-align:right"><p>2019</p></td>
<td class="text-align:right"><p>88.0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>9</p></td>
<td class="text-align:right"><p>555</p></td>
<td class="text-align:right"><p>TPCS INFO TECH</p></td>
<td class="text-align:right"><p>2020</p></td>
<td class="text-align:right"><p>78.0</p></td>
</tr>
</tbody>
</table>
<p>So even though many of them use a combination of <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> and <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> for these scenarios we might run into situations like this. There are a couple of ways to deal with these kinds of scenarios, and we will learn about <code class="docutils literal notranslate"><span class="pre">subquery</span></code> in our next class, which will help you capture ties.</p>
</div>
</div>
</div>
</div>
<div class="section" id="lap-2">
<h2><span class="section-number">1.5. </span>Lap 2 üßã<a class="headerlink" href="#lap-2" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="aggregations">
<h3><span class="section-number">1.5.1. </span>Aggregations<a class="headerlink" href="#aggregations" title="Permalink to this headline">¬∂</a></h3>
<p>So far, we have returned columns in our select statement. We can also use aggregation functions that operate on rows to summarize the data in the form of a single value. Here is a list of aggregation functions in SQL:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MAX()</p></td>
<td><p>maximum value</p></td>
</tr>
<tr class="row-odd"><td><p>MIN()</p></td>
<td><p>minimum value</p></td>
</tr>
<tr class="row-even"><td><p>AVG()</p></td>
<td><p>average value</p></td>
</tr>
<tr class="row-odd"><td><p>SUM()</p></td>
<td><p>sum of values</p></td>
</tr>
<tr class="row-even"><td><p>COUNT()</p></td>
<td><p>number of values</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT COUNT(course_name) FROM courses;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>count</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>17</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>The above query is counting number of values in the column <code class="docutils literal notranslate"><span class="pre">course_name</span></code>. it‚Äôs also sort of like counting the number of rows. We can also pass the <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> columns into these operations. For example, the below query will find the number of courses available in the university.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT COUNT(DISTINCT course_name) FROM courses;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>count</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>9</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select AVG(course_percentage) 
FROM courses
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>avg</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>87.70588235294117</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>Few things to keep in mind when dealing with the aggregation function</p>
<ul class="simple">
<li><p>You are not restricted in using just one aggregation function in the SELECT statement.‚úÖ</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">course_name</span><span class="p">),</span><span class="k">max</span><span class="p">(</span><span class="n">course_percentage</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">courses</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>You CAN‚ÄôT use aggregations and regular columns in a single query. You can use only when you have a <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> clause. (will discuss soon)‚ùå</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">course_name</span><span class="p">),</span><span class="n">course_percentage</span> <span class="k">FROM</span> <span class="n">courses</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>You CAN‚ÄôT use aggregation function in a where clause. The following query is wrong ‚ùå</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">courses</span> <span class="k">WHERE</span> <span class="n">course_percentage</span> <span class="o">&lt;</span> <span class="k">AVG</span><span class="p">(</span><span class="n">course_percentage</span><span class="p">);</span>
</pre></div>
</div>
<p>You can answer this question when we discuss subqueries in the next class (another reason to learn subqueries :) )</p>
</div>
<div class="section" id="grouping">
<h3><span class="section-number">1.5.2. </span>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¬∂</a></h3>
<p>The aggregations we learned in our previous session also become useful when using the <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> statement. <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> statement divides a table into groups of rows based on the values of one or more columns. Once this grouping is done, you can apply your aggregation to these groups.</p>
<p>Syntax:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
    <span class="n">grouping_columns</span><span class="p">,</span> <span class="n">aggregated_columns</span>
<span class="k">FROM</span>
    <span class="n">table1</span>
<span class="k">GROUP</span> <span class="k">BY</span>
    <span class="n">grouping_columns</span>
</pre></div>
</div>
<p>Example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select * from courses;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>id</th>
            <th>student_no</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select course_name, AVG(course_percentage) 
FROM courses
group by course_name;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>course_name</th>
            <th>avg</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Data Visualization</td>
            <td>86.66666666666667</td>
        </tr>
        <tr>
            <td>Introduction to Genomics</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Large Scale Infrastructures</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>Spark Programming</td>
            <td>91.5</td>
        </tr>
        <tr>
            <td>Web and Cloud Computing</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>Health and Technology</td>
            <td>80.5</td>
        </tr>
        <tr>
            <td>C programming</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>TPCS INFO TECH</td>
            <td>90.5</td>
        </tr>
        <tr>
            <td>Parallel Computing</td>
            <td>88.5</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>We can also perform a multi level grouping;</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select course_name, course_year,AVG(course_percentage) 
FROM courses
group by course_name, course_year
having AVG(course_percentage) &lt;90 ;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>course_name</th>
            <th>course_year</th>
            <th>avg</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>88.5</td>
        </tr>
        <tr>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.5</td>
        </tr>
        <tr>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.5</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>Now, what if I want to see only the courses with an average of less than 90 %? We mentioned before that this kind of filtering (filtering on the aggregation function) is not possible using <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> statement, and that‚Äôs why we want the <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> statement to do filtering using these aggregated values.</p>
</div>
<div class="section" id="having">
<h3><span class="section-number">1.5.3. </span>HAVING<a class="headerlink" href="#having" title="Permalink to this headline">¬∂</a></h3>
<p>Syntax:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
    <span class="n">grouping_columns</span><span class="p">,</span> <span class="n">aggregated_columns</span>
<span class="k">FROM</span>
    <span class="n">table1</span>
<span class="k">GROUP</span> <span class="k">BY</span>
    <span class="n">grouping_columns</span>
<span class="k">HAVING</span>
    <span class="n">group_condition</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To summarize:</p>
<ul class="simple">
<li><p>WHERE filters rows before grouping. It filters records in a table level</p></li>
<li><p>HAVING filters groups after grouping. It filters records in a group level</p></li>
</ul>
</div>
<p>For example, let‚Äôs get the question we raised at the end of the grouping section. I want to see the courses with a course average of less than 90 %?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select course_name, AVG(course_percentage) 
FROM courses
group by course_name
having AVG(course_percentage) &lt;90 ;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>course_name</th>
            <th>avg</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Data Visualization</td>
            <td>86.66666666666667</td>
        </tr>
        <tr>
            <td>Introduction to Genomics</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Large Scale Infrastructures</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>Health and Technology</td>
            <td>80.5</td>
        </tr>
        <tr>
            <td>C programming</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Parallel Computing</td>
            <td>88.5</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="using-alias-as">
<h3><span class="section-number">1.5.4. </span>Using alias (AS)<a class="headerlink" href="#using-alias-as" title="Permalink to this headline">¬∂</a></h3>
<p>Until now, we have been referring tables as table names and columns as column names from the schema. But when writing SQL, we are not required to use the same column and table names as in the schema. Instead, we can create aliases for a column or a table using the keyword <code class="docutils literal notranslate"><span class="pre">AS</span></code>.</p>
<p>Syntax:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
    <span class="n">column1</span> <span class="p">[</span><span class="k">AS</span><span class="p">]</span> <span class="n">c1</span><span class="p">,</span>
    <span class="n">column2</span> <span class="p">[</span><span class="k">AS</span><span class="p">]</span> <span class="n">c2</span>
<span class="k">FROM</span>
    <span class="n">table1</span> <span class="p">[</span><span class="k">AS</span><span class="p">]</span> <span class="n">t1</span><span class="p">;</span>
</pre></div>
</div>
<p>It‚Äôs entirely optional to use AS, but WHY do we want it?</p>
<ul class="simple">
<li><p>This makes code more readable</p></li>
<li><p>You can return the columns with a more meaningful name</p></li>
<li><p>Helps a lot when we do JOINS ( wait for the next topic)</p></li>
</ul>
<p>Let‚Äôs rewrite our previous query using AS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select course_name, course_year,AVG(course_percentage)  AS &quot;average course percentage&quot;
FROM courses AS c
group by course_name, course_year
having AVG(course_percentage) &lt;90 ;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>course_name</th>
            <th>course_year</th>
            <th>average course percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>88.5</td>
        </tr>
        <tr>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.5</td>
        </tr>
        <tr>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.5</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
SELECT *
FROM courses;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>id</th>
            <th>student_no</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="checkpoint-2-take-some-time-and-think-if-you-can">
<h3><span class="section-number">1.5.5. </span>Checkpoint 2 !! Take some time and think if you can‚Ä¶<a class="headerlink" href="#checkpoint-2-take-some-time-and-think-if-you-can" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>Do some aggregations and grouping queries using SQL.</p>
<ul>
<li><p>GROUP BY</p></li>
<li><p>aggregation functions</p></li>
<li><p>HAVING</p></li>
</ul>
</li>
</ul>
<p>Until now, you deal with queries on a single table. What if we are interested in data from another table as well? For example, I am interested in seeing the course details (from the <code class="docutils literal notranslate"><span class="pre">courses</span></code> table) and the students (from the <code class="docutils literal notranslate"><span class="pre">students</span></code> table) related to those courses. In these situations, we use joins. Let‚Äôs learn how to stitch tables together. Before that, let‚Äôs do some exercise‚Ä¶</p>
</div>
<div class="section" id="check-point-2-exercise">
<h3><span class="section-number">1.5.6. </span>Check point 2 exercise.<a class="headerlink" href="#check-point-2-exercise" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="id1">
<h4><span class="section-number">1.5.6.1. </span>iclicker questions<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h4>
<p><em><strong>Question 1:</strong></em> Spot the issue, if any, in this SQL query</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">course_name</span><span class="p">),</span><span class="k">max</span><span class="p">(</span><span class="n">course_percentage</span><span class="p">),</span><span class="n">course_percentage</span> 
<span class="k">FROM</span> <span class="n">courses</span> <span class="p">;</span>
</pre></div>
</div>
<p>A: Multiple aggregation functions in the SELECT statement</p>
<p>B: No issues</p>
<p>C: Can‚Äôt use DISTINCT inside an aggregation function</p>
<p>D: Can‚Äôt use aggregations and regular columns in a single query</p>
<div class="toggle docutils container">
<p><em><strong>Answer: D</strong></em></p>
</div>
<p><em><strong>Question 2:</strong></em> Spot the issue, if any, in this SQL query</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">course_name</span><span class="p">),</span><span class="k">max</span><span class="p">(</span><span class="n">course_percentage</span><span class="p">),</span><span class="n">course_year</span>
<span class="k">FROM</span> <span class="n">courses</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">course_year</span><span class="p">;</span>
</pre></div>
</div>
<p>A: Multiple aggregation functions in the SELECT statement</p>
<p>B: No issues</p>
<p>C: Can‚Äôt use DISTINCT inside an aggregation function</p>
<p>D: Can‚Äôt use aggregations and regular columns in a single query</p>
<div class="toggle docutils container">
<p><em><strong>Answer: B</strong></em></p>
</div>
<p><em><strong>Question 3:</strong></em> Spot the issue, if any, in this SQL query</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">course_name</span><span class="p">),</span><span class="k">max</span><span class="p">(</span><span class="n">course_percentage</span><span class="p">),</span><span class="n">course_year</span>
<span class="k">FROM</span> <span class="n">courses</span> 
<span class="k">WHERE</span> <span class="n">course_name</span> <span class="o">!=</span> <span class="s1">&#39;TPCS INFO TECH&#39;</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">course_year</span>
<span class="k">having</span> <span class="n">course_percentage</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">;</span>
</pre></div>
</div>
<p>A: No issues</p>
<p>B: Can‚Äôt use column <code class="docutils literal notranslate"><span class="pre">course_year</span></code> in <code class="docutils literal notranslate"><span class="pre">SELECT</span></code></p>
<p>C: Can‚Äôt use WHERE when using aggregation functions</p>
<p>D: Can‚Äôt use course_percentage in a <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> statement</p>
<div class="toggle docutils container">
<p><em><strong>Answer: D</strong></em></p>
</div>
</div>
<div class="section" id="id2">
<h4><span class="section-number">1.5.6.2. </span>Reasoning Question<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h4>
<p><em><strong>Question 1:</strong></em> We learned the <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> clause, and we used it with aggregate functions. Using table <code class="docutils literal notranslate"><span class="pre">courses</span></code>, write a SQL query using <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> without any aggregation function. Write your findings and learnings.</p>
<div class="toggle docutils container">
<p>You must have tried a variety of SQL queries and got into error;</p>
<p><em><strong>select * FROM courses
group by course_name;</strong></em></p>
<p><em><strong>select course_year,course_name
FROM courses
group by course_name;</strong></em></p>
<p>Below is one query that runs, and this query can be considered equivalent to using <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> if no aggregate functions are used.</p>
<p><em><strong>select course_name
FROM courses
group by course_name;</strong></em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In an aggregation query, the unaggregated expressions need to be consistent with the <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> expressions. And all other expressions need to use aggregation functions</p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="lap-3">
<h2><span class="section-number">1.6. </span>Lap 3 üßÉ<a class="headerlink" href="#lap-3" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="join">
<h3><span class="section-number">1.6.1. </span>Join<a class="headerlink" href="#join" title="Permalink to this headline">¬∂</a></h3>
<p>Syntax:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
    <span class="n">columns</span>
<span class="k">FROM</span>
    <span class="n">left_table</span>
<span class="n">join_type</span>
    <span class="n">right_table</span>
<span class="k">ON</span>
    <span class="n">join_condition</span>
<span class="p">;</span>
</pre></div>
</div>
<p>Following are the types of joins</p>
</div>
<div class="section" id="cross-join">
<h3><span class="section-number">1.6.2. </span>Cross join<a class="headerlink" href="#cross-join" title="Permalink to this headline">¬∂</a></h3>
<p>This is the simplest way of performing a join by cross joining 2 tables (like the cartesian product from your relational algebra classes), in our case, table <code class="docutils literal notranslate"><span class="pre">students</span></code> and <code class="docutils literal notranslate"><span class="pre">courses</span></code>. This kind of join returns all possible combinations of rows from <code class="docutils literal notranslate"><span class="pre">students</span></code> and <code class="docutils literal notranslate"><span class="pre">courses</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT
    *
FROM
    students
CROSS JOIN
    courses
;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
153 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>student_no</th>
            <th>stud_name</th>
            <th>age</th>
            <th>major</th>
            <th>id</th>
            <th>student_no_1</th>
            <th>course_name</th>
            <th>course_year</th>
            <th>course_percentage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>1</td>
            <td>111</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>2</td>
            <td>111</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>88.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>3</td>
            <td>222</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>80.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>4</td>
            <td>222</td>
            <td>Web and Cloud Computing</td>
            <td>2019</td>
            <td>91.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>5</td>
            <td>222</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>6</td>
            <td>333</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>90.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>7</td>
            <td>444</td>
            <td>Large Scale Infrastructures</td>
            <td>2019</td>
            <td>83.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>8</td>
            <td>444</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>9</td>
            <td>555</td>
            <td>TPCS INFO TECH</td>
            <td>2020</td>
            <td>78.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>10</td>
            <td>555</td>
            <td>Health and Technology</td>
            <td>2020</td>
            <td>81.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>11</td>
            <td>666</td>
            <td>Data Visualization</td>
            <td>2021</td>
            <td>85.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>12</td>
            <td>666</td>
            <td>Parallel Computing</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>13</td>
            <td>888</td>
            <td>Spark Programming</td>
            <td>2019</td>
            <td>93.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>14</td>
            <td>999</td>
            <td>TPCS INFO TECH</td>
            <td>2019</td>
            <td>98.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>15</td>
            <td>999</td>
            <td>Data Visualization</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>16</td>
            <td>1000</td>
            <td>C programming</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>MDS</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>MDS</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>MBAN</td>
            <td>17</td>
            <td>1111</td>
            <td>Introduction to Genomics</td>
            <td>2019</td>
            <td>87.0</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>But in real life, we usually perform joins on a column, and we will discuss some types of joins on columns in the following sections. Since we are performing joins on a column, we need to pass that information using the <code class="docutils literal notranslate"><span class="pre">ON</span></code> keyword to give which columns are used to stitch the tables together</p>
</div>
</div>
<div class="section" id="inner-join">
<h3><span class="section-number">1.6.3. </span>Inner join<a class="headerlink" href="#inner-join" title="Permalink to this headline">¬∂</a></h3>
<p>Inner join only returns the matching rows from the left and right tables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT s.student_no,s.stud_name,s.age,c.course_name
FROM
    students AS s
INNER JOIN
    courses AS c
ON
    s.student_no = c.student_no;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>student_no</th>
            <th>stud_name</th>
            <th>age</th>
            <th>course_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Web and Cloud Computing</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>Large Scale Infrastructures</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Check how we are using the alias <code class="docutils literal notranslate"><span class="pre">AS</span></code> we learned in the previous session.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the returned table, student ‚ÄúHeidy‚Äù is missing as that student is not taking any courses and is not mentioned in the <code class="docutils literal notranslate"><span class="pre">courses</span></code>. Also, the courses ‚ÄúC programming‚Äù and ‚ÄúIntroduction to Genomics‚Äù are missing since no students from our <code class="docutils literal notranslate"><span class="pre">student</span></code> table are taking these courses.</p>
</div>
</div>
<div class="section" id="outer-join">
<h3><span class="section-number">1.6.4. </span>Outer join<a class="headerlink" href="#outer-join" title="Permalink to this headline">¬∂</a></h3>
<p>An outer join returns all the rows from one or both of the tables that join. There are 3 variations of it.</p>
<div class="section" id="left-outer">
<h4><span class="section-number">1.6.4.1. </span>Left outer<a class="headerlink" href="#left-outer" title="Permalink to this headline">¬∂</a></h4>
<p>The first table that appears in the query is the left table, and the one appearing after the <code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> keyword is the right table.</p>
<p>A left outer join returns all rows from the left table (matching or not), in addition to the matching rows from both tables. So the non-matching rows from the left table are assigned null values in the columns that belong to the right table.</p>
<p>If you think about it from a Venn diagram perspective, it will look like‚Ä¶</p>
<a class="reference internal image-reference" href="../_images/left.png"><img alt="../_images/left.png" src="../_images/left.png" style="width: 40%;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT s.student_no,s.stud_name,s.age,c.course_name
FROM
    students AS s
LEFT OUTER JOIN
    courses AS c
ON
    s.student_no = c.student_no;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>student_no</th>
            <th>stud_name</th>
            <th>age</th>
            <th>course_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Web and Cloud Computing</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>Large Scale Infrastructures</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>None</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="right-outer">
<h4><span class="section-number">1.6.4.2. </span>Right outer<a class="headerlink" href="#right-outer" title="Permalink to this headline">¬∂</a></h4>
<p>It behaves exactly in the same way as a left join, except that it keeps all rows from the right table and only the matching ones from the left table.</p>
<p>If you think about it from a Venn diagram perspective, it will look like.</p>
<a class="reference internal image-reference" href="../_images/right.png"><img alt="../_images/right.png" src="../_images/right.png" style="width: 40%;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT s.student_no,s.stud_name,s.age,c.course_name
FROM
    students AS s
RIGHT OUTER JOIN
    courses AS c
ON
    s.student_no = c.student_no;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>student_no</th>
            <th>stud_name</th>
            <th>age</th>
            <th>course_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Web and Cloud Computing</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>Large Scale Infrastructures</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>None</td>
            <td>None</td>
            <td>None</td>
            <td>C programming</td>
        </tr>
        <tr>
            <td>None</td>
            <td>None</td>
            <td>None</td>
            <td>Introduction to Genomics</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
<div class="section" id="full-outer">
<h4><span class="section-number">1.6.4.3. </span>Full outer<a class="headerlink" href="#full-outer" title="Permalink to this headline">¬∂</a></h4>
<p>left join + right join = full outer join.</p>
<p>It retrieves matching and non-matching rows from both tables.</p>
<p>If you think about it from a Venn diagram perspective, it will look like.</p>
<a class="reference internal image-reference" href="../_images/full.png"><img alt="../_images/full.png" src="../_images/full.png" style="width: 40%;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT s.student_no,s.stud_name,s.age,c.course_name
FROM
    students AS s
FULL OUTER JOIN
    courses AS c
ON
    s.student_no = c.student_no;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>student_no</th>
            <th>stud_name</th>
            <th>age</th>
            <th>course_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Catherine</td>
            <td>23</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Web and Cloud Computing</td>
        </tr>
        <tr>
            <td>222</td>
            <td>Tiff</td>
            <td>28</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>333</td>
            <td>John</td>
            <td>23</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>Large Scale Infrastructures</td>
        </tr>
        <tr>
            <td>444</td>
            <td>Amir</td>
            <td>28</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>555</td>
            <td>Gittu</td>
            <td>20</td>
            <td>Health and Technology</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>666</td>
            <td>Isha</td>
            <td>30</td>
            <td>Parallel Computing</td>
        </tr>
        <tr>
            <td>888</td>
            <td>Angela</td>
            <td>27</td>
            <td>Spark Programming</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>TPCS INFO TECH</td>
        </tr>
        <tr>
            <td>999</td>
            <td>Jason</td>
            <td>30</td>
            <td>Data Visualization</td>
        </tr>
        <tr>
            <td>None</td>
            <td>None</td>
            <td>None</td>
            <td>C programming</td>
        </tr>
        <tr>
            <td>None</td>
            <td>None</td>
            <td>None</td>
            <td>Introduction to Genomics</td>
        </tr>
        <tr>
            <td>777</td>
            <td>Heidy</td>
            <td>30</td>
            <td>None</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</div>
</div>
<div class="section" id="summarize">
<h3><span class="section-number">1.6.5. </span>Summarize:<a class="headerlink" href="#summarize" title="Permalink to this headline">¬∂</a></h3>
<p><em><strong>CARTESIAN JOIN:</strong></em> returns the Cartesian product of the sets of records from the two or more joined tables.</p>
<p><em><strong>INNER JOIN:</strong></em> returns rows when there is a match in both tables.</p>
<p><em><strong>LEFT JOIN:</strong></em> returns all rows from the left table, even if there are no matches in the right table.</p>
<p><em><strong>RIGHT JOIN:</strong></em> returns all rows from the right table, even if there are no matches in the left table.</p>
<p><em><strong>FULL JOIN:</strong></em> combines the results of both left and right outer joins.</p>
<p>We learned now about the joins. You know now how to join 2 tables. Once you joined 2 tables its sort of behave like another table that you apply the operations what we learned.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
select s.stud_name,c.course_name, c.course_year
FROM students AS s
INNER JOIN
courses AS c
ON  s.student_no = c.student_no
WHERE course_name = &#39;Data Visualization&#39;
ORDER BY course_year DESC;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * postgresql://postgres:***@postgres.cwq2624hiuap.us-west-2.rds.amazonaws.com:5432/postgres
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 rows affected.
</pre></div>
</div>
<div class="output text_html"><table>
    <thead>
        <tr>
            <th>stud_name</th>
            <th>course_name</th>
            <th>course_year</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Isha</td>
            <td>Data Visualization</td>
            <td>2021</td>
        </tr>
        <tr>
            <td>Catherine</td>
            <td>Data Visualization</td>
            <td>2019</td>
        </tr>
        <tr>
            <td>Jason</td>
            <td>Data Visualization</td>
            <td>2019</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We can have all the keywords we learned in a single SQL query, and we have come across some in previous examples. <code class="docutils literal notranslate"><span class="pre">BUT</span></code> the order of SQL keywords <code class="docutils literal notranslate"><span class="pre">DOES</span></code> matter: SELECT, FROM, JOIN, WHERE, GROUP BY, HAVING, ORDER BY, LIMIT.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>We experienced performing joins on 2 tables, but joins can also be performed on multiple tables. Multi joins in SQL work by progressively creating derived tables one after the other. Here is the link that explains this <a class="reference external" href="https://www.interfacett.com/blogs/multiple-joins-work-just-like-single-joins/">process</a></p>
</div>
</div>
<div class="section" id="checkpoint-3-take-some-time-and-think-if-you-can">
<h3><span class="section-number">1.6.6. </span>Checkpoint 3 !! Take some time and think if you can‚Ä¶<a class="headerlink" href="#checkpoint-3-take-some-time-and-think-if-you-can" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>Understand different kinds of joins</p></li>
<li><p>When to use joins</p></li>
<li><p>Write SQL queries to join tables</p></li>
</ul>
</div>
<div class="section" id="check-point-3-exercise">
<h3><span class="section-number">1.6.7. </span>Check point 3 exercise.<a class="headerlink" href="#check-point-3-exercise" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="id3">
<h4><span class="section-number">1.6.7.1. </span>iclicker questions<a class="headerlink" href="#id3" title="Permalink to this headline">¬∂</a></h4>
<p><em><strong>Question 1:</strong></em> Spot the issue, if any, in this SQL query</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">s</span><span class="p">.</span><span class="n">stud_name</span><span class="p">,</span><span class="k">c</span><span class="p">.</span><span class="n">course_name</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="n">course_year</span>
<span class="k">FROM</span> <span class="n">students</span> <span class="k">AS</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span>
<span class="n">courses</span> <span class="k">AS</span> <span class="k">c</span>
<span class="k">ON</span>  <span class="n">s</span><span class="p">.</span><span class="n">student_no</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">student_no</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">course_year</span> <span class="k">DESC</span>
<span class="k">WHERE</span> <span class="n">course_name</span> <span class="o">=</span> <span class="s1">&#39;Data Visualization&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>A: There are some issues with the join key</p>
<p>B: No issues</p>
<p>C: Can‚Äôt specify alias when performing a join</p>
<p>D: ORDER BY need to come after the WHERE clause</p>
<div class="toggle docutils container">
<p><em><strong>Answer: D</strong></em></p>
</div>
<p><em><strong>Question 2:</strong></em> ‚ÄúIn this Venn diagram green color indicate left outer join‚Äù - is this statement TRUE/FALSE?</p>
<a class="reference internal image-reference" href="../_images/color.png"><img alt="../_images/color.png" src="../_images/color.png" style="width: 40%;" /></a>
<p>A: TRUE</p>
<p>B: FALSE</p>
<div class="toggle docutils container">
<p><em><strong>Answer: FALSE</strong></em></p>
<p>The following figure is what indicates the left outer join.</p>
<a class="reference internal image-reference" href="../_images/left.png"><img alt="../_images/left.png" src="../_images/left.png" style="width: 40%;" /></a>
<p>But what is given here is a special scenario where we apply left join to be useful. For example, what if we want to find all students who are not taking any courses?</p>
<p>SELECT s.student_no,s.stud_name,s.age,c.course_name
FROM
students AS s
LEFT OUTER JOIN
courses AS c
ON
s.student_no = c.student_no
WHERE c.student_no is NULL</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>student_no</p></th>
<th class="text-align:right head"><p>stud_name</p></th>
<th class="text-align:right head"><p>age</p></th>
<th class="text-align:right head"><p>course_name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>777</p></td>
<td class="text-align:right"><p>Heidy</p></td>
<td class="text-align:right"><p>30</p></td>
<td class="text-align:right"><p>None</p></td>
</tr>
</tbody>
</table>
<p>Ahaa..! looks like ‚Äúheidy‚Äù is not taking any courses; we need to check with her to see why she is not taking any courses :)</p>
</div>
</div>
</div>
</div>
<div class="section" id="finish-line">
<h2><span class="section-number">1.7. </span>üèÅ Finish line üèÅ üç∫<a class="headerlink" href="#finish-line" title="Permalink to this headline">¬∂</a></h2>
<p>Are you able to recollect our 3 checkpoints?</p>
<ul class="simple">
<li><p><em><strong>Checkpoint 1:</strong></em> Take some time and think if you can‚Ä¶</p>
<ul>
<li><p>Select columns and bring in rows just what we needed (using SELECT &amp; WHERE)</p></li>
<li><p>Return DISTINCT elements</p></li>
<li><p>ORDER BY rows returned based on column(s)</p></li>
<li><p>LIMIT the number of rows returned</p></li>
</ul>
</li>
<li><p><em><strong>Checkpoint 2:</strong></em> Take some time and think if you can‚Ä¶</p>
<ul>
<li><p>Do some aggregations and grouping queries using SQL.</p>
<ul>
<li><p>GROUP BY</p></li>
<li><p>aggregation functions</p></li>
<li><p>HAVING</p></li>
</ul>
</li>
</ul>
</li>
<li><p><em><strong>Checkpoint 3:</strong></em> Take some time and think if you can‚Ä¶</p>
<ul>
<li><p>Understand different kinds of joins</p></li>
<li><p>When to use joins</p></li>
<li><p>Write SQL queries to join tables</p></li>
</ul>
</li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ggeorg02/BAIT580",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">CPSC 304 Introduction to Relational Databases</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Gittu George, PhD<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>